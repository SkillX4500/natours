const e=(e,a)=>{t();let o=`<div class="alert alert--${e}">${a}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",o),setTimeout(t,3e3)},t=()=>{let e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},a=async(t,a)=>{try{let o=await axios({method:"post",url:"/api/v1/users/login",data:{email:t,password:a}});"success"===o.data.status&&(e("success","You are logged in !"),setTimeout(()=>{location.assign("/")},1500))}catch(t){e("error",t.response.data.message)}},o=async()=>{try{let e=await axios({method:"get",url:"/api/v1/users/logout"});"success"===e.data.status&&setTimeout(()=>{location.assign("/")},1e3)}catch(t){console.log(t),e("error","Error logging out. Try again !")}},s=async(t,a)=>{try{let o=await axios({method:"PATCH",url:"password"===a?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe",data:t});"success"===o.data.status&&e("success",`${a.toUpperCase()} Updated Successfully!`)}catch(t){e("error",t.response.data.message)}},n=async t=>{try{let a=await axios({method:"POST",url:"/api/v1/users/signup",data:t});"success"===a.data.status&&(e("success","Welcome to Natours!"),setTimeout(()=>{location.assign("/")},1500))}catch(t){e("error",t.response.data.message)}},r=async t=>{try{let e=await axios({method:"post",url:`/api/v1/bookings/checkout-session/${t}`});location.assign(e.data.session.url)}catch(t){console.log(t),e("error",t.message)}},d=document.getElementById("map"),c=document.querySelector(".form--login"),l=document.querySelector(".form--signup"),u=document.querySelector(".nav__el--logout"),m=document.querySelector(".form-user-data"),i=document.querySelector(".form-user-password"),p=document.getElementById("book-tour");if(d){let e=JSON.parse(d.dataset.locations);(e=>{let t=L.map("map",{zoomControl:!1,center:[38.372,-100.765],zoom:13});L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}).addTo(t);var a=L.icon({iconUrl:"/img/pin.png",iconSize:[30,40],iconAnchor:[16,45],popupAnchor:[0,-50]});let o=[];e.forEach(e=>{o.push([e.coordinates[1],e.coordinates[0]]),L.marker([e.coordinates[1],e.coordinates[0]],{icon:a}).addTo(t).bindPopup(`<p>Day ${e.day}: ${e.description}</p>`,{autoClose:!1,className:"mapPopup"}).openPopup()});let s=L.latLngBounds(o).pad(.5);t.flyToBounds(s),t.scrollWheelZoom.disable()})(e)}c&&c.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("email").value,o=document.getElementById("password").value;a(t,o)}),l&&l.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("name").value,a=document.getElementById("email").value,o=document.getElementById("password").value,s=document.getElementById("passwordCon").value;n({name:t,email:a,password:o,passwordConfirm:s})}),u&&u.addEventListener("click",o),m&&m.addEventListener("submit",e=>{e.preventDefault();let t=new FormData;t.append("name",document.getElementById("name").value),t.append("email",document.getElementById("email").value),t.append("photo",document.getElementById("photo").files[0]),s(t,"data")}),i&&i.addEventListener("submit",async e=>{e.preventDefault();let t=document.getElementById("password-current").value,a=document.getElementById("password").value,o=document.getElementById("password-confirm").value;document.querySelector(".btn--save-password").textContent="Updating...",await s({passwordCurrent:t,password:a,passwordConfirm:o},"password"),document.querySelector(".btn--save-password").textContent="Save password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value=""}),p&&p.addEventListener("click",async e=>{e.target.textContent="Processing...",await r(e.target.dataset.tourId)});
//# sourceMappingURL=index.js.map
